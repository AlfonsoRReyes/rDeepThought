---
title: "R Notebook"
output: html_notebook
---

```{r}
reticulate::use_condaenv("r-tensorflow")
reticulate::py_config()
```



```{python}
import numpy as np

X_train = np.linspace(0, 80, 100).reshape(-1, 1)
Y_train = 5 * X_train


from keras.models import Sequential
from keras.layers import Dense
from keras.layers.core import Activation, Dense

# define base mode
def baseline_model():
    # create model
    model = Sequential()
    model.add(Dense(1, input_dim=1, init='normal', activation='relu'))
    model.add(Dense(1, init='normal'))
    model.compile(loss='mean_squared_error', optimizer='adam')
    return model

regr = baseline_model()
regr.fit(X_train, Y_train,          
          nb_epoch=200, validation_split=0.2, verbose = 1) #batch_size=5,

```

