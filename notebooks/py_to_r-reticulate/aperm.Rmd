---
title: "R Notebook"
output: html_notebook
---

We have a three dimension array 2x3x4.
By default, in R, it will be filled column-major, or columns fill first.

```{r}
# column-major fill
myarray <- array( 1:24, dim = c(2,3,4))
myarray
```

Applying permutation `aperm` to the array:

```{r}
myarray2 <- aperm(myarray, c(1,2,3))
myarray2
```

This should yield zero array:
```{r}
myarray - myarray2
```

## by row-major

    This array:
        myarray <- array(1:n, dim = c(nr, nc, ns))
    
    will yield the same array as:
        aperm(myarray, c(1, 2, 3))
        
        

A mnemonic rule:    
```{r}
#                     + -----  # the 2nd dimension is columns
# aperm(myarray, c(1, 2, 3))   # column-major order, as in R, Fortran

  aperm(myarray, c(3, 1, 2))
#                     + ----- the second dimension is now rows
#                     + shift to the right one dimension 
#                     + to make it row-major
```

```{r}
# 4x3x2
library(reticulate)
np <- import("numpy", convert = FALSE)
n <- 25; nr <- 4L; nc <- 3L; ns <- 2L
x  <- np$arange(1, n)$reshape(c(nr, nc, ns))
x
```

```{r}
# 4x3x2
py <- py_to_r(x)
py
```

## Reproduce the array in R

```{r}
# create the matrix
# in order to reproduce the Python array
# what makes the difference is the order "byrow=TRUE" in the matrix
m <- matrix(1:(n-1), c(nc * nr, ns), byrow = TRUE)
m
```

```{r}
# create the array from the matrix
a <- array(m, c(nc, nr, ns))
a
```

```{r}
# transpose and resize
p <- aperm(a, c(2,1,3))
p
```

> Now it is the same as the array generated in Python.

```{r}
p - py
```

## This is not the correct way

```{r}
arr <- array(1:n, dim = c(nr, nc, ns))
arr
```

```{r}
aperm(arr, c(1, 2, 3))
aperm(arr, c(3, 2, 1))
aperm(arr, c(2, 1, 3))
```


```{r}
aperm(arr, c(3, 2, 1), resize = FALSE)
aperm(arr, c(2, 1, 3), resize = FALSE)
```





## with a 2x2 matrix
```{r}
a <- array(1:4, c(2,2,1))
a
```

column-major = fill the columns first?


```{r}
aperm(a, c(3,1,2))
```




```{r}
myarray <- array( 1:24, dim=c(2,3,4),
 dimnames=list(One=c('a','b'), Two=c('A','B','C'), Three=1:4) )

myarray
aperm(myarray, c(3,1,2))
```
