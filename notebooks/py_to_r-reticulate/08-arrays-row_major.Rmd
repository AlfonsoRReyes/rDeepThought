---
title: "Arrays in row-major order"
output: html_notebook
---


## Python array in row-major (by default)
Python by default creates arrays in row-major order

```{r}
library(reticulate)
np <- import("numpy", convert = FALSE)

(x.py.rm <- np$reshape(np$arange(1, 25), c(4L, 3L, 2L)))
```

> these two expressions are equivalent (both are ordered row-major:

```{text}
    py_to_r(np$reshape(np$arange(1, 25), c(4L, 3L, 2L)))
    py_to_r(np$arange(1,25)$reshape(4L, 3L, 2L))
```    

## Another way of creating a numpy array as row-major

```{r}
# py_to_r(np$reshape(np$arange(1, 25), c(4L, 3L, 2L)))
# py_to_r(np$arange(1,25)$reshape(4L, 3L, 2L))

identical(
    py_to_r(np$reshape(np$arange(1, 25), c(4L, 3L, 2L))),
    py_to_r(np$arange(1,25)$reshape(4L, 3L, 2L))
)
```

> This is how row-major looks in R printing.

```{r}
(y.py.rm <- py_to_r(x.py.rm))
```

## Row-major array using `array_reshape`

```{r}
library(reticulate)

array_reshape(1:24, dim = c(4,3,2), order = "C")   # row-major like in "C"
```

## Using `aperm` R function

> Let's generate the same array in R (row-major):

```{r}
m <- matrix(1:24, c(3 * 4, 2), byrow = TRUE)
(z.r.rm <- aperm(array(m, dim = c(3, 4, 2)), c(2, 1, 3)))
```

> Now, if both arrays are the same, the difference must be zero:

```{r}
y.py.rm - z.r.rm
```



